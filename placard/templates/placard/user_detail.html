{% extends "main.html" %}


{% block title %}{{ luser }} detail | Users{% endblock %}


{% load admin_static %}
{% block extrastyle %}
<link rel="stylesheet" type="text/css" href="{% static "css/forms.css" %}" />
{% endblock %}


{% block breadcrumbs %}
<div class="breadcrumbs">
<a href='{{ base_url|default:"/" }}'>Home</a>
 &rsaquo; <a href="{% url plac_user_list %}">Users</a>
 &rsaquo; {{ luser }} detail
</div>
{% endblock %}


{% block object-tools %}
<div class="module object-tools">
    <h2>User links</h2>
    <ul>
        <li><a href="{% url plac_user_detail_verbose luser.pk %}">Verbose output</a></li>
        {% block object-tools-view %}{% endblock %}
        {% if perms.placard.change_account or perms.placard.hr_change_account %}
        <li><a href="{% url plac_user_edit luser.pk %}">Edit details</a></li>
        {% endif %}
        {% if perms.placard.change_account_password %}
        <li><a href="{% url plac_change_password luser.pk %}">Change password</a></li>
        {% endif %}
        {% if perms.placard.lock_account %}
            {% if luser.is_locked %}
            <li><a href="{% url plac_unlock_user luser.pk %}">Unlock</a></li>
            {% else %}
            <li><a href="{% url plac_lock_user luser.pk %}">Lock</a></li>
            {% endif %}
        {% endif %}
    </ul>
</div>
{% endblock %}


{% block content %}
<div id="content-main">

    <div class="module {% if luser.is_locked %}locked{% endif %}">
        <h2>User {{ luser }} detail</h2>

        <h3>{{ luser.cn }}</h3>
        <table>
            {% if luser.is_locked %}
            <tr>
            <td>Status</td><td>LOCKED</td>
            </tr>
            {% else %}
            <tr>
            <td>Status</td><td>Unlocked</td>
            </tr>
            {% endif %}
            <tr>
            <td>Username</td><td>{{ luser.uid }}</td>
            </tr>
            <tr>
            <td>Title</td><td>{{ luser.title }}</td>
            </tr>
            <tr>
            <td>Email</td><td>{{ luser.mail|urlize }}</td>
            </tr>
            <tr>
            <td>Phone</td><td>{{ luser.telephoneNumber }}</td>
            </tr>
            <tr>
            <td>Mobile</td><td>{{ luser.mobile }}</td>
            </tr>	
            <tr>
            <td>Fax</td><td>{{ luser.facsimileTelephoneNumber }}</td>
            </tr>
            {% if luser.jpegPhoto %}
            <tr>
            <td>Photo</td><td><img src="{% url plac_user_photo luser.pk %}" /></td>
            </tr>
            {% endif %}
            <tr>
            <td>Description</td><td>{{ luser.description|linebreaks }}</td>
            </tr>
            <tr>
            <td>dn</td><td>{{ luser.dn }}</td>
            </tr>
            <tr>
            <td>uidNumber</td><td>{{ luser.uidNumber }}</td>
            </tr>
            <tr>
            <td>gidNumber</td><td>{{ luser.gidNumber }}</td>
            </tr>
            <tr>
            <td>homeDirectory</td><td>{{ luser.homeDirectory }}</td>
            </tr>
            <tr>
            <td>unixHomeDirectory</td><td>{{ luser.unixHomeDirectory }}</td>
            </tr>
            <tr>
            <td>loginShell</td><td>{{ luser.loginShell }}</td>
            </tr>
            {% with luser.managed_by.get_obj as manager %}
            {% if manager %}
            <tr>
            <td>Manager</td><td class="{% if manager.is_locked %}locked{% endif %}"><a href="{% url plac_user_detail manager.pk %}">{{ manager }}</a></td>
            </tr>
            {% endif %}
            {% endwith %}
            {% with luser.manager_of.all as manager_of %}
            {% if manager_of %}
            <tr>
            <td>Manager of</td><td>
            {% for p in manager_of %}
            <span class="{% if p.is_locked %}locked{% endif %}"><a href="{% url plac_user_detail p.pk %}">{{ p }}</a></span>{% if not forloop.last %}, {% endif %}
            {% endfor %}
            </td></tr>
            {% endif %}
            {% endwith %}
            <tr>
            <td>objectClass</td><td>{{ luser.objectClass }}</td>
            </tr>
            <tr>
            <td>givenName</td><td>{{ luser.givenName }}</td>
            </tr>
            <tr>
            <td>sn</td><td>{{ luser.sn }}</td>
            </tr>	
        </table>
        </div>
        <div class="module">
        <h2>Groups</h2>
        <table>
            {% with luser.primary_group.get_obj as primary_group %}
            {% if primary_group %}
            <tr>
                <th>Primary Group:</th>
            </tr>
            <tr>
                <td><a href="{% url plac_grp_detail primary_group.pk %}">{{ primary_group }}</a></td>
            </tr>
            {% endif %}
            {% endwith %}
            <tr>
                <th>Secondary Groups:</th>
            </tr>
            {% for g in luser.secondary_groups.all %}
                <tr class="{% cycle row1,row2 %}">
                    <td><a href="{% url plac_grp_detail g.pk %}">{{ g }}</a></td>
                    {% if perms.placard.change_account %}
                    <td><a href="{% url plac_user_rm_group luser.pk,g.pk %}" class="deletelink">remove</a></td>
                    {% endif %}
                </tr>
            {% endfor %}
        </table>
        {% if perms.placard.change_account %}
            <form method="post" action="{% url plac_user_add_group luser.pk %}" class="simple">{% csrf_token %}
                <fieldset>
                    {{ form }}<input type="submit" value="Add" class="default" />
                </fieldset>
            </form>
        {% endif %}
    </div>
</div>
{% endblock %}
